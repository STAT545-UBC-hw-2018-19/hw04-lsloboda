---
title: "hw04-exercise"
output:
   html_document:
      self_contained: false
      keep_md: true
---

# Tidy data and joins

## Initialize the data

* Load the gapminder, tidyverse and knitr libraries:

```{r}
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(gapminder))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(kableExtra))
```

* The kableExtra package gives new options for styling tables, but since they are in HTML, we won't get to see the effects in this .md file
* We will take a quick look at the data to *sanity check* that the data and variables appear as we expect:

```{r}
(head(gapminder))
```

* Everything looks as expected, so let's start exploring the data

## Data Re-shaping Prompt
*Activity 2: Make a tibble with one row per year and columns for life expectancy for two or more countries. Use kable() to make the table look pretty. Scatterplot life expectancy for one country against that of another.*

### Method
* Reduce the data subset using select and group_by
* Spread the countries across the columns
* Build a table and a scatterplot

```{r}
q1_table <- gapminder %>% #Create a tibble so we can re-use it later
  select(year, country, lifeExp) %>% #Reduce the data set size for faster processing
    group_by(year) %>% 
      spread(key = "country", value = "lifeExp") %>% 
        select("Canada", "Germany", "Brazil")# %>%

q1_table %>% 
  kable(col.names = c("Year", "Canada", "Germany", "Brazil")) %>% #Use kable to enhance the output
    kable_styling()

#Check that the data is a tibble
#Change my graph theme

```
#Plot

```{r}
q1_table %>%
  ggplot(aes(x = year, y = value, color = variable)) +
  geom_point(aes(y = Canada, col = "Canada"), size=5) +
  geom_line(aes(y = Canada, col = "Canada")) +
  geom_point(aes(y = Germany, col = "Germany"), size=5) +
  geom_line(aes(y = Germany, col = "Germany")) +
  geom_point(aes(y = Brazil, col = "Brazil"), size=5) +
  geom_line(aes(y = Brazil, col = "Brazil")) +
  #Add labels
  labs(title = "Life expectancy from 1952-2007, (Canada, Germany, Brazil)",
    x = "Year", y = "Life Expectancy",
    color = "Countries\n")

```

### Observations & Analyses
I didn't end up using gather() (which effectively does the opposite as spread.

## Join Prompt (join, merge, look up)
*Activity 2: Make your own cheatsheet; iterate between your data prep and your joining to make your explorations comprehensive and interesting. Demonstrate all the types of joins.*

### Method
* Create two tables with some overlapping columns and rows
* Explore different types of joins

```{r}
medieval_weapons <- "
name,        attack_type, wielding,       damage
shuriken,    ranged,      one-handed,     2       
flail,       melee,       one-handed,     4        
great_sword, melee,       two-handed,     8      
crossbow,    ranged,      one-handed,     2        
Excalibur,   melee,       one-handed,     6        
dagger,      melee,       one-handed,     3       
staff,       melee,       two-handed,     5       
"
medieval_weapons <- read_csv(medieval_weapons, skip = 1)

stun_bonus <- "
  wielding,   chance_to_stun,   stun_damage
  two-handed, 0.15,             10
"
stun_bonus <- read_csv(stun_bonus, skip = 1)

```

### Left and Right Joins

```{r}
lj <- left_join(medieval_weapons, stun_bonus, by = "wielding")
rj <- right_join(medieval_weapons, stun_bonus, by = "wielding")
kable(
  list(lj, rj),
  col.names = c("Weapon", "Attack Type", "Wielding Type", "Damage (HP)", "Chance to Stun", "Stun Damage (HP)"))
```

On the left is a left join, on the right is a right join.
### Inner and Full Joins

```{r}
ij <- inner_join(medieval_weapons, stun_bonus, by = "wielding") 
fj <- full_join(medieval_weapons, stun_bonus, by = "wielding") 
kable(
  list(ij, fj),
  col.names = c("Weapon", "Attack Type", "Wielding Type", "Damage (HP)", "Chance to Stun", "Stun Damage (HP)"))

```

```{r}
sj <- semi_join(medieval_weapons, stun_bonus, by = "wielding") 
aj <- anti_join(medieval_weapons, stun_bonus, by = "wielding") 
kable(
  list(ij, fj),
  col.names = c("Weapon", "Attack Type", "Wielding Type", "Damage (HP)", "Chance to Stun", "Stun Damage (HP)"))
```



*Activity 3: Explore the merge() and match() functions. Contrast and compare.*

### Method
* Reduce the data subset using se


